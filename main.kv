#:import C kivy.utils.get_color_from_hex  
   
WindowManager:
    MainWindow:
    SecondWindow:
    ThirdWindow:
    FourthWindow:

<Button>
    background_normal: 'buttonNormal.png'
    background_color: C("#1B3B6F") 

<ToggleButton>
    background_normal: 'buttonNormal.png'
    background_color: C("#1b7cab") if self.state == 'normal' else C('#06405c')

<TextInput>
    width: 10
    multiline: False
    height: 25
    width: 1



<MainWindow>:
    name: "main"

    GridLayout:
        cols:1
        size_hint: .95,.95
        pos_hint: {"center_x": 0.5, "top": 1}
        Label:
            text: "Movie Generator"

        Button:
            text: "Set your preferences."
            on_release:
                root.setBack("main")
                app.root.current = "input" 
                root.manager.transition.direction = "left"
                
        Button:
            text: "Results from previously set inputs."
            on_release:
                root.setBack("main")
                app.root.current = "results" 
                root.manager.transition.direction = "left"


<SecondWindow>:
    name: "input"
    FloatLayout:
        GridLayout:
            size_hint: .9, 0.15
            pos_hint: {"center_x": 0.5, "top": .95 }
            cols: 1
            Label:
                text:"What is your preferred maximum runtime? (Input an number between 45 - 467)"
            
            TextInput:
                id:maxruntime
                
            Label:
                text:"What is your preferred minimum runtime? (Input an number between 45 - 467)"
            
            TextInput:
                id:minruntime
    
        GridLayout:
            cols:1
            size_hint: .9, .05
            pos_hint: {"center_x": 0.5, "top": 0.785 }
            
            Label:
                text: "What genre would you like? (for best results, choose 1 - 2)"
                
        GridLayout:
            id: genrecontainer
            cols: 5
            size_hint: .9, .3
            pos_hint: {"center_x": 0.5, "top": 0.745 }
            
            ToggleButton:
                id: actionbut
                text: "Action"
            
            ToggleButton:
                id: adventurebut
                text: "Adventure"
               
            ToggleButton:
                id: animationbut
                text: "Animation"
            
            ToggleButton:
                id: biographybut
                text: "Biography"
            
            ToggleButton:
                id: comedybut
                text: "Comedy"
            
            ToggleButton:
                id: crimebut
                text: "Crime"
                
            ToggleButton:
                id: documentarybut
                text: "Documentary"
                
            ToggleButton:
                id: dramabut
                text: "Drama"
            
            ToggleButton:
                id: familybut
                text: "Family"
                
            ToggleButton:
                id: fantasybut
                text: "Fantasy"
            
            ToggleButton:
                id: gameshowbut
                text: "Game-Show"    
                
            ToggleButton:
                id: historybut
                text: "History"
            
            ToggleButton:
                id: horrorbut
                text: "Horror"
            
            ToggleButton:
                id: musicbut
                text: "Music"
            
            ToggleButton:
                id: musicalbut
                text: "Musical"
    
            ToggleButton:
                id: mysterybut
                text: "Mystery"
            
            ToggleButton:
                id: newsbut
                text: "News"
            
            ToggleButton:
                id: realitytvbut
                text: "Reality-TV"
            
            ToggleButton:
                id: romancebut
                text: "Romance"
                
            ToggleButton:
                id: scifibut
                text: "Sci-Fi"
                
            ToggleButton:
                id: sportbut
                text: "Sport"
                
            ToggleButton:
                id: talkshowbut
                text: "Talk-Show"
                
            ToggleButton:
                id: thrillerbut
                text: "Thriller"
                
            ToggleButton:
                id: warbut
                text: "War"
            
            ToggleButton:
                id: westernbut
                text: "Western"
                
        GridLayout:
            size_hint: .9, 0.15
            pos_hint: {"center_x": 0.5, "top": .425 }
            cols: 1
            Label:
                text:"What is your preferred maximum year of release? (Input an integer between 1915 - 2022)"
            
            TextInput:
                id:maxyear
                
            Label:
                text:"What is your preferred minimum year of release? (Input an integer between 1915 - 2022)"
            
            TextInput:
                id:minyear
                
        GridLayout:
            size_hint: .9, 0.15
            pos_hint: {"center_x": 0.5, "top": .275 }
            cols: 1
            Label:
                text:"What is your preferred maximum rating? (Input a number between 1 - 9.7)"
            
            TextInput:
                id:maxrating
                
            Label:
                text:"What is your preferred minimum rating? (Input a number between 1 - 9.7)"
            
            TextInput:
                id:minrating
                
        GridLayout:
            size_hint: 0.8, 0.08
            pos_hint: {"center_x": 0.5, "top": 0.105}
            cols:3
            Button:
                text: "Save"
                on_release: 
                    root.saveTimes()
                    root.saveGenre()
                    root.saveYear()
                    root.saveRatings()
                    root.popup()
                    
            Button:
                text: "Next"
                on_release:
                    move = (root.returnBoolPref())
                    print(move)
                    if move: \
                    root.setBack("input") 
                    if move: \
                    app.root.current = "importance" 
                    if move: \
                    root.manager.transition.direction = "left"
                    else: \
                    root.popup2()
                    
            Button:
                text: "Back"
                on_release:
                    screen = root.returnBack()
                    app.root.current = screen
                    root.manager.transition.direction = "right"
            
        
        
<ThirdWindow>:
    name: "importance"
    FloatLayout:
        GridLayout:
            cols:1
            size_hint: .9, .1
            pos_hint: {"center_x": 0.5, "top": 0.95 }
            
            Label:
                text: "Which input is most important to you? (1st)"
                
        GridLayout:
            id: firstcontainer
            cols: 3
            size_hint: .9, .15
            pos_hint: {"center_x": 0.5, "top": 0.85 }
            
            ToggleButton:
                id: genrebut1
                group: "buttons1"
                text: "Genres"
                state: "down"
            
            ToggleButton:
                id: yearbut1
                group: "buttons1"
                text: "Year"
               
            ToggleButton:
                id: ratingbut1
                group: "buttons1"
                text: "Rating"
                
        GridLayout:
            cols:1
            size_hint: .9, .1
            pos_hint: {"center_x": 0.5, "top": 0.67 }
            
            Label:
                text: "Which input is second most important to you? (2nd)"
                
        GridLayout:
            id: secondcontainer
            cols: 3
            size_hint: .9, .15
            pos_hint: {"center_x": 0.5, "top": 0.57 }
            
            ToggleButton:
                id: genrebut2
                group: "buttons2"
                text: "Genres"
            
            ToggleButton:
                id: yearbut2
                group: "buttons2"
                text: "Year"
                state: "down"
               
            ToggleButton:
                id: ratingbut2
                group: "buttons2"
                text: "Rating"
                
        GridLayout:
            cols:1
            size_hint: .9, .1
            pos_hint: {"center_x": 0.5, "top": 0.39 }
            
            Label:
                text: "Which input is most third important to you? (3rd)"
                
        GridLayout:
            id: thirdcontainer
            cols: 3
            size_hint: .9, .15
            pos_hint: {"center_x": 0.5, "top": 0.29 }
            
            ToggleButton:
                id: genrebut3
                group: "buttons3"
                text: "Genres"
            
            ToggleButton:
                id: yearbut3
                group: "buttons3"
                text: "Year"
               
            ToggleButton:
                id: ratingbut3
                group: "buttons3"
                text: "Rating"
                state: "down"
                
        GridLayout:
            size_hint: 0.8, 0.08
            pos_hint: {"center_x": 0.5, "top": 0.105}
            cols:3
            Button:
                text: "Save"
                on_release: 
                    root.determineImportance()
                    root.popup()
                    
            Button:
                text: "Next"
                on_release:
                    move = (root.returnBoolPref() and root.returnBoolImport())
                    print(move)
                    if move: \
                    root.setBack("importance") 
                    if move: \
                    app.root.current = "results" 
                    if move: \
                    root.manager.transition.direction = "left"
                    else: \
                    root.popup2()
                    
            Button:
                text: "Back"
                on_release:
                    app.root.current = "input"
                    root.manager.transition.direction = "right"
  

<FourthWindow>:
    name: "results"
    FloatLayout:
        GridLayout:
            size_hint: 0.8, 0.1
            pos_hint: {"center_x": 0.5, "top": .95}
            cols:1
            
            Label:
                id: statusLabel
                text: "Load your results."
    
        
        GridLayout:
            cols: 1
            size_hint: 0.8, 0.6
            height: 400
            pos_hint: {"center_x": 0.5, "top": .8}
            ScrollView:
                Label:
                    id: resultLabel
                    text: ""
                    size_hint: 1, None
                    text_size: self.width, None
                    height: self.texture_size[1]
                
    
        GridLayout:
            size_hint: 0.8, 0.08
            pos_hint: {"center_x": 0.5, "top": 0.2}
            cols:3
            
            Button:
                text: "Load"
                on_press:
                    root.ids.statusLabel.text = "Loading..."
                on_release:
                    root.ids.statusLabel.text = "If you did not receive optimal results, please increase your range of runtime.\nYou may refresh to recieve more movie recommendations."
                    root.returnTopRefreshedMlist1()
                    root.returnLabelText() 
            
            Button:
                text: "Refresh"
                on_press:
                    root.ids.statusLabel.text = "Loading..."
                on_release:
                    root.repeatRefresh()
                    root.returnLabelText()
            
            Button:
                text: "Back"
                on_release:
                    screen = root.returnBack()
                    app.root.current = screen
                    root.manager.transition.direction = "right"
                    
        GridLayout:
            size_hint: 0.8, 0.08
            pos_hint: {"center_x": 0.5, "top": 0.10}
            cols: 1      
            Button:
                text: "Main"
                on_release:
                    app.root.current = "main"
                    root.manager.transition.direction = "right"
